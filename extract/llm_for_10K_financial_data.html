<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.40">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Using Large Language Models to Identify Financial Concepts from 10-K Reports</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="llm_for_10K_financial_data_files/libs/clipboard/clipboard.min.js"></script>
<script src="llm_for_10K_financial_data_files/libs/quarto-html/quarto.js"></script>
<script src="llm_for_10K_financial_data_files/libs/quarto-html/popper.min.js"></script>
<script src="llm_for_10K_financial_data_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="llm_for_10K_financial_data_files/libs/quarto-html/anchor.min.js"></script>
<link href="llm_for_10K_financial_data_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="llm_for_10K_financial_data_files/libs/quarto-html/quarto-syntax-highlighting-549806ee2085284f45b00abea8c6df48.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="llm_for_10K_financial_data_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="llm_for_10K_financial_data_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="llm_for_10K_financial_data_files/libs/bootstrap/bootstrap-e1410b04cc7f3ad098892ee0af4d0b3a.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-full">

<main class="content column-page" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Using Large Language Models to Identify Financial Concepts from 10-K Reports</h1>
</div>


<div class="quarto-title-meta-author column-page">
  <div class="quarto-title-meta-heading">Authors</div>
  <div class="quarto-title-meta-heading">Affiliations</div>
  
    <div class="quarto-title-meta-contents">
    <p class="author">Calvin Williamson </p>
  </div>
  <div class="quarto-title-meta-contents">
        <p class="affiliation">
            Science and Math, Fashion Institute of Technology
          </p>
      </div>
    <div class="quarto-title-meta-contents">
    <p class="author">Jia Mei Lin </p>
  </div>
  <div class="quarto-title-meta-contents">
        <p class="affiliation">
            Jay and Patty Baker School of Business and Technology, FIT
          </p>
      </div>
  </div>

<div class="quarto-title-meta column-page">

      
  
    
  </div>
  


</header>


<p>Open the colab notebook here:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="https://colab.research.google.com/github/calvinw/BusMgmtBenchmarks/blob/main/extract/llm_for_10K_financial_data.ipynb"><img src="https://colab.research.google.com/assets/colab-badge.svg" class="img-fluid figure-img" alt="Open In Colab"></a></p>
<figcaption>Open In Colab</figcaption>
</figure>
</div>
<p>In this notebook we give the idea behind the extraction technique we use to get financial facts from annual 10-K reports. The main idea involves calling an LLM with a version of the income statement and the balance sheet from a 10-K annual report and asking it to identify some financial concepts we are interested in.</p>
<p>We will use the amazingly useful <a href="https://github.com/dgunning/edgartools">edgartools</a> package for filtering and finding the SEC 10-K filings for our companies.</p>
<p>For each of our companies we are interested in identifying these concepts from company 10-K reports:</p>
<ul>
<li>Net Revenue</li>
<li>Cost of Goods</li>
<li>SG&amp;A</li>
<li>Operating Profit</li>
<li>Net Profit</li>
<li>Inventory</li>
<li>Current Assets</li>
<li>Total Assets</li>
<li>Current Liabilities</li>
<li>Total Shareholder Equity</li>
<li>Total Liabilities and Shareholder Equity</li>
</ul>
<p>The reason we want to do this is so that we can build a tool that will allow you to easily compare these values for different companies and for companies and segments they belong to.</p>
<p>We will find the latest 10-K by using the <a href="https://github.com/dgunning/edgartools">edgartools</a> package. The code behind the library is a very efficient API front end for queries to the SEC edgar REST api.</p>
<p>Of course once you have a mapping of the labels in the report to the standard gaap attributes taxonomy for the company you are interested in you could look the facts labeled with those attribute names on subsequent reports from the same company. We dont illustrate that but it makes sense if you need want to optimize looking up this information for multiple years for the same company and speed and if LLM costs are an issue.</p>
<p>Our dataset is so small and the LLM costs are minimal for what we want so we dont pursue that kind of optimization.</p>
<div id="d2251273" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>pip install edgartools</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>pip install openai</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>pip install pandas</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Do some imports and set the display to print out just 10 rows of dataframes.</p>
<div id="49543f1b" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> edgar <span class="im">import</span> set_identity, Company</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>pd.set_option(<span class="st">'display.max_rows'</span>, <span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="using-edgartools-to-load-the-10k-for-a-company" class="level2">
<h2 class="anchored" data-anchor-id="using-edgartools-to-load-the-10k-for-a-company">Using Edgartools to Load the 10K for a Company</h2>
<p>You must set your email address in order for edgartools to access the SEC edgar website. Change “YourEmailAddress” below to be your email address.</p>
<div id="92087feb" class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set identity</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>set_identity(<span class="st">"YourEmailAddress"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Next we use the CIK to download the latest 10K for the company. You can find the CIKs for companies that are American filing at the SEC website.</p>
<div id="ebd22698" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Use the CIK for lululemon </span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>cik <span class="op">=</span> <span class="st">"1397187"</span>  </span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the company object using the CIK</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>company <span class="op">=</span> Company(cik)</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Fetch the 10-K filings</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>filings <span class="op">=</span> company.get_filings(form<span class="op">=</span><span class="st">"10-K"</span>)</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Just get the latest 10-K</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>filing <span class="op">=</span> filings[<span class="dv">0</span>]</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>filing_obj <span class="op">=</span> filing.obj()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="getting-the-income-statement-and-the-balance-sheet-as-dataframe" class="level2">
<h2 class="anchored" data-anchor-id="getting-the-income-statement-and-the-balance-sheet-as-dataframe">Getting the Income Statement and the Balance Sheet as Dataframe</h2>
<p>First we get the income statement as a dataframe.</p>
<div id="0099c3ec" class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>income_df <span class="op">=</span> filing_obj.income_statement.to_dataframe()</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>income_df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="4">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">2024</th>
<th data-quarto-table-cell-role="th">2023</th>
<th data-quarto-table-cell-role="th">2022</th>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">label</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">Net revenue</td>
<td>9619278000</td>
<td>8110518000</td>
<td>6256617000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Cost of goods sold</td>
<td>-4009873000</td>
<td>-3618178000</td>
<td>-2648052000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Gross profit</td>
<td>5609405000</td>
<td>4492340000</td>
<td>3608565000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Selling, general and administrative expenses</td>
<td>-3397218000</td>
<td>-2757447000</td>
<td>-2225034000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Impairment of goodwill and other assets, restructuring costs</td>
<td>74501000</td>
<td>407913000</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Comprehensive income</td>
<td>1538518000</td>
<td>798133000</td>
<td>956560000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Basic earnings per share (in dollars per share)</td>
<td>12.23</td>
<td>6.70</td>
<td>7.52</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Diluted earnings per share (in dollars per share)</td>
<td>12.20</td>
<td>6.68</td>
<td>7.49</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Basic weighted-average number of shares outstanding (in shares)</td>
<td>126726000</td>
<td>127666000</td>
<td>129768000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Diluted weighted-average number of shares outstanding (in shares)</td>
<td>127060000</td>
<td>128017000</td>
<td>130295000</td>
</tr>
</tbody>
</table>

<p>21 rows × 3 columns</p>
</div>
</div>
</div>
<p>You can see that the current year is in one column and the previous years after that.</p>
<p>The labels are not a separate column, they are actually “indices” to the rows, so the data we want is in the first column (with index=0). So we can drop the columns after that since we only need the current year data. We use <code>iloc</code> to do that as follows:</p>
<div id="2c5eb407" class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>income_df <span class="op">=</span> income_df.iloc[:, :<span class="dv">1</span>]</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>income_df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="5">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">2024</th>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">label</th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">Net revenue</td>
<td>9619278000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Cost of goods sold</td>
<td>-4009873000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Gross profit</td>
<td>5609405000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Selling, general and administrative expenses</td>
<td>-3397218000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Impairment of goodwill and other assets, restructuring costs</td>
<td>74501000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Comprehensive income</td>
<td>1538518000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Basic earnings per share (in dollars per share)</td>
<td>12.23</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Diluted earnings per share (in dollars per share)</td>
<td>12.20</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Basic weighted-average number of shares outstanding (in shares)</td>
<td>126726000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Diluted weighted-average number of shares outstanding (in shares)</td>
<td>127060000</td>
</tr>
</tbody>
</table>

<p>21 rows × 1 columns</p>
</div>
</div>
</div>
<p>Now we have our labels and the column of data from 2024, the latest in this case.</p>
<p>This will be cleaner for sending to the LLM, it doesnt need the older years data</p>
<p>Next we get the balance sheet as a dataframe. Again we just keep the labels and the first column that has the data we want in it</p>
<div id="1998b412" class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>balance_df <span class="op">=</span> filing_obj.balance_sheet.to_dataframe()</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>balance_df <span class="op">=</span> balance_df.iloc[:, :<span class="dv">1</span>]</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>balance_df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="6">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">2024</th>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">label</th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">Cash and cash equivalents</td>
<td>2243971000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Accounts receivable, net</td>
<td>124769000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Inventories</td>
<td>1323602000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Prepaid and receivable income taxes</td>
<td>183733000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Prepaid expenses and other current assets</td>
<td>184502000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Additional paid-in capital</td>
<td>575369000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Retained earnings</td>
<td>3920362000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Accumulated other comprehensive loss</td>
<td>-264256000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Total stockholders' equity</td>
<td>4232081000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Total liabilities and stockholders' equity</td>
<td>7091941000</td>
</tr>
</tbody>
</table>

<p>36 rows × 1 columns</p>
</div>
</div>
</div>
</section>
<section id="compare-to-sec-filing-web-page" class="level2">
<h2 class="anchored" data-anchor-id="compare-to-sec-filing-web-page">Compare to SEC Filing Web Page</h2>
<p>You can compare these to a copy of the report filed by the company with the SEC. The following html is included in company’s official report to the SEC and we just reproduce it here so you can compare. Every 10-K has this kind of html page and its any easy reference for seeing if we pulled the right values.</p>
<div id="432e1543" class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> IPython.display <span class="im">import</span> IFrame</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>IFrame(src<span class="op">=</span><span class="st">"https://calvinw.github.io/BusMgmtBenchmarks/extract/html/Lululemon-2024.html"</span>, width<span class="op">=</span><span class="dv">900</span>, height<span class="op">=</span><span class="dv">900</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="7">

        <iframe width="900" height="900" src="https://calvinw.github.io/BusMgmtBenchmarks/extract/html/Lululemon-2024.html" frameborder="0" allowfullscreen=""></iframe>
        
</div>
</div>
</section>
<section id="convert-the-dataframes-to-markdown-to-prepare-for-llm-call" class="level2">
<h2 class="anchored" data-anchor-id="convert-the-dataframes-to-markdown-to-prepare-for-llm-call">Convert the Dataframes to Markdown to Prepare for LLM Call</h2>
<p>We convert the dataframes to markdown tables to prepare to send them to an LLM</p>
<p>We use the <code>to_markdown</code> method of the dataframe.</p>
<p>Here is the income statement as markdown:</p>
<div id="865654bb" class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>income_markdown_table <span class="op">=</span> income_df.to_markdown(index<span class="op">=</span><span class="va">True</span>, floatfmt<span class="op">=</span><span class="st">".0f"</span>)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(income_markdown_table)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>| label                                                             |        2024 |
|:------------------------------------------------------------------|------------:|
| Net revenue                                                       |  9619278000 |
| Cost of goods sold                                                | -4009873000 |
| Gross profit                                                      |  5609405000 |
| Selling, general and administrative expenses                      | -3397218000 |
| Impairment of goodwill and other assets, restructuring costs      |    74501000 |
| Amortization of intangible assets                                 |    -5000000 |
| Acquisition-related expenses                                      |          -0 |
| Gain on disposal of assets                                        |          -0 |
| Income from operations                                            |  2132676000 |
| Other income (expense), net                                       |    43059000 |
| Income before income tax expense                                  |  2175735000 |
| Income tax expense                                                |  -625545000 |
| Net income                                                        |  1550190000 |
| Foreign currency translation adjustment                           |   -23077000 |
| Net investment hedge gains (losses)                               |    11405000 |
| Other comprehensive income (loss), net of tax                     |   -11672000 |
| Comprehensive income                                              |  1538518000 |
| Basic earnings per share (in dollars per share)                   |          12 |
| Diluted earnings per share (in dollars per share)                 |          12 |
| Basic weighted-average number of shares outstanding (in shares)   |   126726000 |
| Diluted weighted-average number of shares outstanding (in shares) |   127060000 |</code></pre>
</div>
</div>
<p>And the balance sheet as markdown:</p>
<div id="c5d7bfbd" class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>balance_markdown_table <span class="op">=</span> balance_df.to_markdown(index<span class="op">=</span><span class="va">True</span>, floatfmt<span class="op">=</span><span class="st">".0f"</span>)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(balance_markdown_table)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>| label                                                                                                       | 2024       |
|:------------------------------------------------------------------------------------------------------------|:-----------|
| Cash and cash equivalents                                                                                   | 2243971000 |
| Accounts receivable, net                                                                                    | 124769000  |
| Inventories                                                                                                 | 1323602000 |
| Prepaid and receivable income taxes                                                                         | 183733000  |
| Prepaid expenses and other current assets                                                                   | 184502000  |
| Total current assets                                                                                        | 4060577000 |
| Property and equipment, net                                                                                 | 1545811000 |
| Right-of-use lease assets                                                                                   | 1265610000 |
| Goodwill                                                                                                    | 24083000   |
| Intangible assets, net                                                                                      | 0          |
| Deferred income tax assets                                                                                  | 9176000    |
| Other non-current assets                                                                                    | 186684000  |
| Total assets                                                                                                | 7091941000 |
| Accounts payable                                                                                            | 348441000  |
| Accrued liabilities and other                                                                               | 348555000  |
| Accrued compensation and related expenses                                                                   | 326110000  |
| Current lease liabilities                                                                                   | 249270000  |
| Current income taxes payable                                                                                | 12098000   |
| Unredeemed gift card liability                                                                              | 306479000  |
| Other current liabilities                                                                                   | 40308000   |
| Total current liabilities                                                                                   | 1631261000 |
| Non-current lease liabilities                                                                               | 1154012000 |
| Non-current income taxes payable                                                                            | 15864000   |
| Deferred income tax liabilities                                                                             | 29522000   |
| Other non-current liabilities                                                                               | 29201000   |
| Total liabilities                                                                                           | 2859860000 |
| Commitments and contingencies                                                                               |            |
| Undesignated preferred stock, $0.01 par value: 5,000 shares authorized; none issued and outstanding         | 0          |
| Exchangeable stock, no par value: 60,000&nbsp;shares authorized; 5,116 and 5,116 issued and outstanding          | 0          |
| Special voting stock, $0.000005&nbsp;par value: 60,000&nbsp;shares authorized; 5,116 and 5,116 issued and outstanding | 0          |
| Common stock, $0.005&nbsp;par value: 400,000&nbsp;shares authorized; 121,106 and 122,205 issued and outstanding       | 606000     |
| Additional paid-in capital                                                                                  | 575369000  |
| Retained earnings                                                                                           | 3920362000 |
| Accumulated other comprehensive loss                                                                        | -264256000 |
| Total stockholders' equity                                                                                  | 4232081000 |
| Total liabilities and stockholders' equity                                                                  | 7091941000 |</code></pre>
</div>
</div>
</section>
<section id="prepare-a-prompt-for-passing-the-income-statement-and-balance-sheet" class="level2">
<h2 class="anchored" data-anchor-id="prepare-a-prompt-for-passing-the-income-statement-and-balance-sheet">Prepare a Prompt for Passing the Income Statement and Balance Sheet</h2>
<p>Now we prepare a prompt to send both the income and balance sheets to the LLM and ask it to find some financial concepts for us. There are many variations of this process, you could also give common terms that you would find these concepts labeled as, or could include the us_gaap taxonomy names for some of the concepts as well.</p>
<p>In the <code>edgartools</code> versions of the the dataframes above there are ways of getting the gaap attributes that the labels corresponds to for each of the rows. One could pass those the to LLM as well, to help it identify the financial concepts that you want, but we dont show that here.</p>
<p>We just rely on the LLM recognizing the concept from the labels in the first column of the income statement and the balance report.</p>
<p>Here’s our prompt with our list of concepts and template variables for the income statement and the balance sheet. This f-string will get filled in with those.</p>
<div id="834388bb" class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>prompt <span class="op">=</span> <span class="ss">f"""Below is a list of financial concepts (given inside the &lt;concepts&gt;</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="ss">tags) to be found in the income statement and the balance sheet of a companies</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="ss">10-K report. </span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="ss">&lt;concepts&gt;</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a><span class="ss">Net Revenue</span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a><span class="ss">Cost of Goods</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a><span class="ss">SG&amp;A</span></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a><span class="ss">Operating Profit</span></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a><span class="ss">Net Profit</span></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a><span class="ss">Inventory</span></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a><span class="ss">Current Assets</span></span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a><span class="ss">Total Assets</span></span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a><span class="ss">Current Liabilities</span></span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a><span class="ss">Total Shareholder Equity</span></span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a><span class="ss">Total Liabilities and Shareholder Equity</span></span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a><span class="ss">&lt;/concepts&gt;</span></span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a><span class="ss">Find the concepts and their values in the income statement or the balance</span></span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a><span class="ss">sheet that follow. </span></span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a><span class="ss">The income statement is enclosed in  &lt;income_statment&gt; tags. </span></span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a><span class="ss">The balance sheet is enclosed in &lt;balance_sheet&gt; tags.</span></span>
<span id="cb13-24"><a href="#cb13-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-25"><a href="#cb13-25" aria-hidden="true" tabindex="-1"></a><span class="ss">Here is the income statement:</span></span>
<span id="cb13-26"><a href="#cb13-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-27"><a href="#cb13-27" aria-hidden="true" tabindex="-1"></a><span class="ss">&lt;income_statement&gt;</span></span>
<span id="cb13-28"><a href="#cb13-28" aria-hidden="true" tabindex="-1"></a><span class="sc">{</span>income_markdown_table<span class="sc">}</span></span>
<span id="cb13-29"><a href="#cb13-29" aria-hidden="true" tabindex="-1"></a><span class="ss">&lt;/income_statement&gt;</span></span>
<span id="cb13-30"><a href="#cb13-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-31"><a href="#cb13-31" aria-hidden="true" tabindex="-1"></a><span class="ss">Here is the balance sheet:</span></span>
<span id="cb13-32"><a href="#cb13-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-33"><a href="#cb13-33" aria-hidden="true" tabindex="-1"></a><span class="ss">&lt;balance_sheet&gt;</span></span>
<span id="cb13-34"><a href="#cb13-34" aria-hidden="true" tabindex="-1"></a><span class="sc">{</span>balance_markdown_table<span class="sc">}</span></span>
<span id="cb13-35"><a href="#cb13-35" aria-hidden="true" tabindex="-1"></a><span class="ss">&lt;/balance_sheet&gt;</span></span>
<span id="cb13-36"><a href="#cb13-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-37"><a href="#cb13-37" aria-hidden="true" tabindex="-1"></a><span class="ss">Please return the values found as strings in a json format as follows. Make</span></span>
<span id="cb13-38"><a href="#cb13-38" aria-hidden="true" tabindex="-1"></a><span class="ss">sure to provide a number for every concept. Respond only with with the</span></span>
<span id="cb13-39"><a href="#cb13-39" aria-hidden="true" tabindex="-1"></a><span class="ss">following format, no other commentary or discussion</span></span>
<span id="cb13-40"><a href="#cb13-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-41"><a href="#cb13-41" aria-hidden="true" tabindex="-1"></a><span class="ss">The Response Format:</span></span>
<span id="cb13-42"><a href="#cb13-42" aria-hidden="true" tabindex="-1"></a><span class="ss">```json</span></span>
<span id="cb13-43"><a href="#cb13-43" aria-hidden="true" tabindex="-1"></a><span class="ch">{{</span></span>
<span id="cb13-44"><a href="#cb13-44" aria-hidden="true" tabindex="-1"></a><span class="ss">    "Net Revenue": &lt;value&gt;,</span></span>
<span id="cb13-45"><a href="#cb13-45" aria-hidden="true" tabindex="-1"></a><span class="ss">    "Cost of Goods": &lt;value&gt;, </span></span>
<span id="cb13-46"><a href="#cb13-46" aria-hidden="true" tabindex="-1"></a><span class="ss">    "SG&amp;A":  &lt;value&gt;,</span></span>
<span id="cb13-47"><a href="#cb13-47" aria-hidden="true" tabindex="-1"></a><span class="ss">    "Operating Profit": &lt;value&gt;,</span></span>
<span id="cb13-48"><a href="#cb13-48" aria-hidden="true" tabindex="-1"></a><span class="ss">    "Net Profit": &lt;value&gt;,</span></span>
<span id="cb13-49"><a href="#cb13-49" aria-hidden="true" tabindex="-1"></a><span class="ss">    "Inventory": &lt;value&gt;,</span></span>
<span id="cb13-50"><a href="#cb13-50" aria-hidden="true" tabindex="-1"></a><span class="ss">    "Current Assets": &lt;value&gt;,</span></span>
<span id="cb13-51"><a href="#cb13-51" aria-hidden="true" tabindex="-1"></a><span class="ss">    "Total Assets": &lt;value&gt;,</span></span>
<span id="cb13-52"><a href="#cb13-52" aria-hidden="true" tabindex="-1"></a><span class="ss">    "Current Liabilities": &lt;value&gt;,</span></span>
<span id="cb13-53"><a href="#cb13-53" aria-hidden="true" tabindex="-1"></a><span class="ss">    "Total Shareholder Equity": &lt;value&gt;,</span></span>
<span id="cb13-54"><a href="#cb13-54" aria-hidden="true" tabindex="-1"></a><span class="ss">    "Total Liabilities and Shareholder Equity": &lt;value&gt;</span></span>
<span id="cb13-55"><a href="#cb13-55" aria-hidden="true" tabindex="-1"></a><span class="ch">}}</span></span>
<span id="cb13-56"><a href="#cb13-56" aria-hidden="true" tabindex="-1"></a><span class="ss">```"""</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Lets take a look at the prompt before we send it:</p>
<div id="9dfb7e47" class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(prompt)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Below is a list of financial concepts (given inside the &lt;concepts&gt;
tags) to be found in the income statement and the balance sheet of a companies
10-K report. 

&lt;concepts&gt;
Net Revenue
Cost of Goods
SG&amp;A
Operating Profit
Net Profit
Inventory
Current Assets
Total Assets
Current Liabilities
Total Shareholder Equity
Total Liabilities and Shareholder Equity
&lt;/concepts&gt;

Find the concepts and their values in the income statement or the balance
sheet that follow. 

The income statement is enclosed in  &lt;income_statment&gt; tags. 
The balance sheet is enclosed in &lt;balance_sheet&gt; tags.

Here is the income statement:

&lt;income_statement&gt;
| label                                                             |        2024 |
|:------------------------------------------------------------------|------------:|
| Net revenue                                                       |  9619278000 |
| Cost of goods sold                                                | -4009873000 |
| Gross profit                                                      |  5609405000 |
| Selling, general and administrative expenses                      | -3397218000 |
| Impairment of goodwill and other assets, restructuring costs      |    74501000 |
| Amortization of intangible assets                                 |    -5000000 |
| Acquisition-related expenses                                      |          -0 |
| Gain on disposal of assets                                        |          -0 |
| Income from operations                                            |  2132676000 |
| Other income (expense), net                                       |    43059000 |
| Income before income tax expense                                  |  2175735000 |
| Income tax expense                                                |  -625545000 |
| Net income                                                        |  1550190000 |
| Foreign currency translation adjustment                           |   -23077000 |
| Net investment hedge gains (losses)                               |    11405000 |
| Other comprehensive income (loss), net of tax                     |   -11672000 |
| Comprehensive income                                              |  1538518000 |
| Basic earnings per share (in dollars per share)                   |          12 |
| Diluted earnings per share (in dollars per share)                 |          12 |
| Basic weighted-average number of shares outstanding (in shares)   |   126726000 |
| Diluted weighted-average number of shares outstanding (in shares) |   127060000 |
&lt;/income_statement&gt;

Here is the balance sheet:

&lt;balance_sheet&gt;
| label                                                                                                       | 2024       |
|:------------------------------------------------------------------------------------------------------------|:-----------|
| Cash and cash equivalents                                                                                   | 2243971000 |
| Accounts receivable, net                                                                                    | 124769000  |
| Inventories                                                                                                 | 1323602000 |
| Prepaid and receivable income taxes                                                                         | 183733000  |
| Prepaid expenses and other current assets                                                                   | 184502000  |
| Total current assets                                                                                        | 4060577000 |
| Property and equipment, net                                                                                 | 1545811000 |
| Right-of-use lease assets                                                                                   | 1265610000 |
| Goodwill                                                                                                    | 24083000   |
| Intangible assets, net                                                                                      | 0          |
| Deferred income tax assets                                                                                  | 9176000    |
| Other non-current assets                                                                                    | 186684000  |
| Total assets                                                                                                | 7091941000 |
| Accounts payable                                                                                            | 348441000  |
| Accrued liabilities and other                                                                               | 348555000  |
| Accrued compensation and related expenses                                                                   | 326110000  |
| Current lease liabilities                                                                                   | 249270000  |
| Current income taxes payable                                                                                | 12098000   |
| Unredeemed gift card liability                                                                              | 306479000  |
| Other current liabilities                                                                                   | 40308000   |
| Total current liabilities                                                                                   | 1631261000 |
| Non-current lease liabilities                                                                               | 1154012000 |
| Non-current income taxes payable                                                                            | 15864000   |
| Deferred income tax liabilities                                                                             | 29522000   |
| Other non-current liabilities                                                                               | 29201000   |
| Total liabilities                                                                                           | 2859860000 |
| Commitments and contingencies                                                                               |            |
| Undesignated preferred stock, $0.01 par value: 5,000 shares authorized; none issued and outstanding         | 0          |
| Exchangeable stock, no par value: 60,000&nbsp;shares authorized; 5,116 and 5,116 issued and outstanding          | 0          |
| Special voting stock, $0.000005&nbsp;par value: 60,000&nbsp;shares authorized; 5,116 and 5,116 issued and outstanding | 0          |
| Common stock, $0.005&nbsp;par value: 400,000&nbsp;shares authorized; 121,106 and 122,205 issued and outstanding       | 606000     |
| Additional paid-in capital                                                                                  | 575369000  |
| Retained earnings                                                                                           | 3920362000 |
| Accumulated other comprehensive loss                                                                        | -264256000 |
| Total stockholders' equity                                                                                  | 4232081000 |
| Total liabilities and stockholders' equity                                                                  | 7091941000 |
&lt;/balance_sheet&gt;

Please return the values found as strings in a json format as follows. Make
sure to provide a number for every concept. Respond only with with the
following format, no other commentary or discussion

The Response Format:
```json
{
    "Net Revenue": &lt;value&gt;,
    "Cost of Goods": &lt;value&gt;, 
    "SG&amp;A":  &lt;value&gt;,
    "Operating Profit": &lt;value&gt;,
    "Net Profit": &lt;value&gt;,
    "Inventory": &lt;value&gt;,
    "Current Assets": &lt;value&gt;,
    "Total Assets": &lt;value&gt;,
    "Current Liabilities": &lt;value&gt;,
    "Total Shareholder Equity": &lt;value&gt;,
    "Total Liabilities and Shareholder Equity": &lt;value&gt;
}
```</code></pre>
</div>
</div>
</section>
<section id="pass-the-prompt-to-an-large-language-model" class="level2">
<h2 class="anchored" data-anchor-id="pass-the-prompt-to-an-large-language-model">Pass the Prompt to an Large Language Model</h2>
<p>We use openai compatible call to OpenRouter but you could use any openai compatible api and key. A good model at the time of writing is DeepSeek-V3, but many models would work well here. I believe many of the lightweight 8B models would work. Gemini Flash 1.5 or 2.0, gpt-4o-mini all work great. Im sure there are many of the more inexpensive models that would work as well.</p>
<section id="set-up-your-llm-provider" class="level3">
<h3 class="anchored" data-anchor-id="set-up-your-llm-provider">Set Up Your LLM Provider</h3>
<p>Paste in the key to your LLM provider as appropriate. You should change the base_url and the environment variable to be appropriate for your situation.</p>
<p>As long as the api you are using is openai compatible you should be fine.</p>
<div id="d0a68640" class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>os.environ[<span class="st">"OPENROUTER_API_KEY"</span>] <span class="op">=</span> <span class="st">"paste_your_api_key_here"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now we call the api. Fix the base_url and api_key. We use DeepSeek V3 but many models would work.</p>
<div id="bff0fb76" class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> openai <span class="im">import</span> OpenAI</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="cf">try</span>:</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>    client <span class="op">=</span> OpenAI(</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>      base_url<span class="op">=</span><span class="st">"https://openrouter.ai/api/v1"</span>,</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>      api_key<span class="op">=</span>os.getenv(<span class="st">"OPENROUTER_API_KEY"</span>)</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>    response <span class="op">=</span> client.chat.completions.create(</span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>        model <span class="op">=</span> <span class="st">"deepseek/deepseek-chat"</span>,</span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>        messages<span class="op">=</span>[</span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>            {<span class="st">"role"</span>: <span class="st">"system"</span>, <span class="st">"content"</span>: <span class="st">"You are a financial document expert assistant."</span>},</span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>            {<span class="st">"role"</span>: <span class="st">"user"</span>, <span class="st">"content"</span>: prompt}</span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>        ],</span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a>        temperature<span class="op">=</span><span class="fl">0.0</span>  <span class="co"># Using 0 temperature for more consistent responses</span></span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a>    llm_response_content <span class="op">=</span> response.choices[<span class="dv">0</span>].message.content</span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a><span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"Error occurred: </span><span class="sc">{</span><span class="bu">str</span>(e)<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb17-21"><a href="#cb17-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-22"><a href="#cb17-22" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"The LLMs response"</span>)</span>
<span id="cb17-23"><a href="#cb17-23" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(llm_response_content)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>The LLMs response
```json
{
    "Net Revenue": "9619278000",
    "Cost of Goods": "4009873000", 
    "SG&amp;A": "3397218000",
    "Operating Profit": "2132676000",
    "Net Profit": "1550190000",
    "Inventory": "1323602000",
    "Current Assets": "4060577000",
    "Total Assets": "7091941000",
    "Current Liabilities": "1631261000",
    "Total Shareholder Equity": "4232081000",
    "Total Liabilities and Shareholder Equity": "7091941000"
}
```</code></pre>
</div>
</div>
</section>
</section>
<section id="check-the-response-from-the-llm" class="level2">
<h2 class="anchored" data-anchor-id="check-the-response-from-the-llm">Check the Response from the LLM</h2>
<p>We could use structred output or json output checking here as well, but we do not show the details of that.</p>
<div id="e0d2a6bf" class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"The income statement again so you can check some of the LLM response: "</span>)</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(income_markdown_table)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>The income statement again so you can check some of the LLM response: 
| label                                                             |        2024 |
|:------------------------------------------------------------------|------------:|
| Net revenue                                                       |  9619278000 |
| Cost of goods sold                                                | -4009873000 |
| Gross profit                                                      |  5609405000 |
| Selling, general and administrative expenses                      | -3397218000 |
| Impairment of goodwill and other assets, restructuring costs      |    74501000 |
| Amortization of intangible assets                                 |    -5000000 |
| Acquisition-related expenses                                      |          -0 |
| Gain on disposal of assets                                        |          -0 |
| Income from operations                                            |  2132676000 |
| Other income (expense), net                                       |    43059000 |
| Income before income tax expense                                  |  2175735000 |
| Income tax expense                                                |  -625545000 |
| Net income                                                        |  1550190000 |
| Foreign currency translation adjustment                           |   -23077000 |
| Net investment hedge gains (losses)                               |    11405000 |
| Other comprehensive income (loss), net of tax                     |   -11672000 |
| Comprehensive income                                              |  1538518000 |
| Basic earnings per share (in dollars per share)                   |          12 |
| Diluted earnings per share (in dollars per share)                 |          12 |
| Basic weighted-average number of shares outstanding (in shares)   |   126726000 |
| Diluted weighted-average number of shares outstanding (in shares) |   127060000 |</code></pre>
</div>
</div>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>